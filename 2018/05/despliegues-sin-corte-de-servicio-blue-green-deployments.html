<!DOCTYPE html>
<html lang="es" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Despliegues sin corte de servicio: blue-green deployments - Linux Sysadmin</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="http://www.linuxsysadmin.ml/2018/05/despliegues-sin-corte-de-servicio-blue-green-deployments.html">

        <meta name="author" content="Gerard" />
        <meta name="keywords" content="blue-green,deployment" />
        <meta name="description" content="Para muchas aplicaciones caseras, nos importa poco parar un servidor de aplicaciones o web. Sin embargo, en el mundo empresarial, un corte de servicio o downtime son palabras mayores, y normalmente vienen seguidos de un papeleo espectacular; otras veces se puede calmar la situación mediante el despido del pobre operador …" />

        <meta property="og:site_name" content="Linux Sysadmin" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Despliegues sin corte de servicio: blue-green deployments"/>
        <meta property="og:url" content="http://www.linuxsysadmin.ml/2018/05/despliegues-sin-corte-de-servicio-blue-green-deployments.html"/>
        <meta property="og:description" content="Para muchas aplicaciones caseras, nos importa poco parar un servidor de aplicaciones o web. Sin embargo, en el mundo empresarial, un corte de servicio o downtime son palabras mayores, y normalmente vienen seguidos de un papeleo espectacular; otras veces se puede calmar la situación mediante el despido del pobre operador …"/>
        <meta property="article:published_time" content="2018-05-28" />
            <meta property="article:section" content="Operaciones" />
            <meta property="article:tag" content="blue-green" />
            <meta property="article:tag" content="deployment" />
            <meta property="article:author" content="Gerard" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://www.linuxsysadmin.ml/theme/css/bootstrap.cosmo.min.css" type="text/css"/>
    <link href="http://www.linuxsysadmin.ml/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://www.linuxsysadmin.ml/theme/css/pygments/vim.css" rel="stylesheet">
    <link rel="stylesheet" href="http://www.linuxsysadmin.ml/theme/css/style.css" type="text/css"/>
        <link href="http://www.linuxsysadmin.ml/static/custom.css" rel="stylesheet">

        <link href="http://www.linuxsysadmin.ml/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Linux Sysadmin ATOM Feed"/>



        <link href="http://www.linuxsysadmin.ml/feeds/operaciones.atom.xml" type="application/atom+xml" rel="alternate"
              title="Linux Sysadmin Operaciones ATOM Feed"/>

    <!-- Begin Cookie Consent plugin by Silktide - http://silktide.com/cookieconsent -->
    <script type="text/javascript">
        window.cookieconsent_options = {"message":"De acuerdo a la ley vigente, estoy obligado a informarte de la obviedad de que este sitio utiliza cookies.","dismiss":"Acepto","learnMore":"Mas información","link":null,"theme":"dark-bottom"};
    </script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/1.0.9/cookieconsent.min.js"></script>
    <!-- End Cookie Consent plugin -->

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://www.linuxsysadmin.ml/" class="navbar-brand">
Linux Sysadmin            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                         <li><a href="http://www.linuxsysadmin.ml/about.html">
                             Sobre mí
                          </a></li>
                         <li><a href="http://www.linuxsysadmin.ml/curriculum.html">
                             Curriculum Vitae
                          </a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="http://www.linuxsysadmin.ml/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archivos</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
            <ol class="breadcrumb">
                <li><a href="http://www.linuxsysadmin.ml" title="Linux Sysadmin"><i class="fa fa-home fa-lg"></i></a></li>
                <li><a href="http://www.linuxsysadmin.ml/category/operaciones.html" title="Operaciones">Operaciones</a></li>
                <li class="active">Despliegues sin corte de servicio: blue-green deployments</li>
            </ol>

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Banner linuxsysadmin -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-6984858420847602"
     data-ad-slot="7977846974"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://www.linuxsysadmin.ml/2018/05/despliegues-sin-corte-de-servicio-blue-green-deployments.html"
                       rel="bookmark"
                       title="Permalink to Despliegues sin corte de servicio: blue-green deployments">
                        Despliegues sin corte de servicio: blue-green deployments
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Fecha</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2018-05-28T10:00:00+02:00"> 2018-05-28</time>
    </span>


            <span class="label label-default">Autor</span>
            <a href="http://www.linuxsysadmin.ml/author/gerard.html"><i class="fa fa-user"></i> Gerard</a>

        <span class="label label-default">Tiempo de lectura</span> 8 minutos
        <span class="label label-default">Categoría</span>
        <a href="http://www.linuxsysadmin.ml/category/operaciones.html">Operaciones</a>


<span class="label label-default">Tags</span>
	<a href="http://www.linuxsysadmin.ml/tag/blue-green.html">blue-green</a>
        /
	<a href="http://www.linuxsysadmin.ml/tag/deployment.html">deployment</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>Para muchas aplicaciones caseras, nos importa poco parar un servidor de aplicaciones o web. Sin embargo, en el mundo empresarial, un corte de servicio o <em>downtime</em> son palabras mayores, y normalmente vienen seguidos de un papeleo espectacular; otras veces se puede calmar la situación mediante el despido del pobre operador.</p>
<p>En un mundo <em>agile</em> en donde los despliegues son el pan de cada semana, nos interesa minimizar, o incluso suprimir, cualquier mención a la probabilidad de un <em>downtime</em>. Para esto existe un patrón que se llama <a href="https://martinfowler.com/bliki/BlueGreenDeployment.html">blue-green deployment</a>.</p>
<p>La idea de fondo es muy simple: tenemos dos entornos iguales llamados <strong>blue</strong> y <strong>green</strong>, precedidos con un <em>proxy</em> o un balanceador que hace fácil dirigir el tráfico hacia uno u otro. Esto significa que podemos modificar uno de los entornos en caliente, sabiendo que <strong>no es producción</strong>. Solamente cuando el entorno secundario funciona bien podemos dirigir el tráfico hacia él, que <strong>se convierte en producción</strong>.</p>
<p><img alt="Blue-green deployment" src="http://www.linuxsysadmin.ml/images/blue-green_deployments.jpg"></p>
<p>En caso de un error catastrófico no detectado, basta con volver a dirigir el tráfico al entorno anterior, que todavía tenemos funcional. Si no hubieran errores, podremos reinstalar este entorno anterior, en vistas a que pase a ser producción en un futuro cercano. Los montajes más habituales ofrecen ambos entornos, sirviendo dos puntos de entrada: uno como entorno de producción y el otro como entorno de pruebas.</p>
<h2>Un ejemplo práctico</h2>
<p>Vamos a exponer una API de ejemplo que no hace nada en especial; es lo de menos en este momento. Vamos a poner dos servidores de aplicaciones por entorno y vamos a hacer balanceo de carga además de la función de dirección de tráfico. Estas son las decisiones de diseño de este ejemplo:</p>
<ul>
<li>Tenemos un servidor llamado <em>proxy</em> que va a ejecutar un <strong>nginx</strong> como balanceador y <em>switch</em>, aunque serviría otro (un <strong>haproxy</strong>, por ejemplo)</li>
<li>El entorno <strong>blue</strong> se compone de dos servidores <em>blue1</em> y <em>blue2</em> escuchando en el puerto 8080</li>
<li>El entorno <strong>green</strong> se compone de dos servidores <em>green1</em> y <em>green2</em> escuchando en el puerto 8080</li>
<li>El puerto 80 del <em>proxy</em> será producción, y el puerto 8080 del mismo servidor servirá como entorno de pruebas</li>
</ul>
<h3>El estado inicial</h3>
<p>Tenemos una versión 1.0.0 en todos los servidores de aplicaciones. La API de ejemplo que ponemos nos muestra claramente la versión y el servidor que atendió la petición, para mayor claridad.</p>
<div class="highlight"><pre><span></span>root@proxy:~# wget -qO- http://blue1:8080/fake/
<span class="o">{</span><span class="s2">&quot;status&quot;</span>: <span class="s2">&quot;200&quot;</span>, <span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;Everything is OK&quot;</span>, <span class="s2">&quot;version&quot;</span>: <span class="s2">&quot;1.0.0&quot;</span>, <span class="s2">&quot;server&quot;</span>: <span class="s2">&quot;blue1&quot;</span><span class="o">}</span>
root@proxy:~# wget -qO- http://blue2:8080/fake/
<span class="o">{</span><span class="s2">&quot;status&quot;</span>: <span class="s2">&quot;200&quot;</span>, <span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;Everything is OK&quot;</span>, <span class="s2">&quot;version&quot;</span>: <span class="s2">&quot;1.0.0&quot;</span>, <span class="s2">&quot;server&quot;</span>: <span class="s2">&quot;blue2&quot;</span><span class="o">}</span>
root@proxy:~# wget -qO- http://green1:8080/fake/
<span class="o">{</span><span class="s2">&quot;status&quot;</span>: <span class="s2">&quot;200&quot;</span>, <span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;Everything is OK&quot;</span>, <span class="s2">&quot;version&quot;</span>: <span class="s2">&quot;1.0.0&quot;</span>, <span class="s2">&quot;server&quot;</span>: <span class="s2">&quot;green1&quot;</span><span class="o">}</span>
root@proxy:~# wget -qO- http://green2:8080/fake/
<span class="o">{</span><span class="s2">&quot;status&quot;</span>: <span class="s2">&quot;200&quot;</span>, <span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;Everything is OK&quot;</span>, <span class="s2">&quot;version&quot;</span>: <span class="s2">&quot;1.0.0&quot;</span>, <span class="s2">&quot;server&quot;</span>: <span class="s2">&quot;green2&quot;</span><span class="o">}</span>
root@proxy:~# 
</pre></div>


<p>Decidimos que el entorno <strong>blue</strong> es actualmente producción, y por lo tanto, <strong>green</strong> es el entorno de pruebas. Simplemente necesitamos modificar la configuración del <strong>nginx</strong> para que apunte cada puerto al entorno que toca, por ejemplo:</p>
<div class="highlight"><pre><span></span>root@proxy:~# cat /etc/nginx/conf.d/api.conf 
upstream blue <span class="o">{</span>
    server blue1:8080<span class="p">;</span>
    server blue2:8080<span class="p">;</span>
<span class="o">}</span>

upstream green <span class="o">{</span>
    server green1:8080<span class="p">;</span>
    server green2:8080<span class="p">;</span>
<span class="o">}</span>

server <span class="o">{</span>
    listen <span class="m">80</span><span class="p">;</span>
    location / <span class="o">{</span>
        proxy_pass http://blue<span class="p">;</span>
    <span class="o">}</span>
<span class="o">}</span>

server <span class="o">{</span>
    listen <span class="m">8080</span><span class="p">;</span>
    location / <span class="o">{</span>
        proxy_pass http://green<span class="p">;</span>
    <span class="o">}</span>
<span class="o">}</span>
root@proxy:~# 
</pre></div>


<p>Recargamos el <strong>nginx</strong> y ya tenemos lo que queríamos:</p>
<ul>
<li>Entorno de producción en el puerto 80, apuntando al entorno <strong>blue</strong></li>
<li>Entorno de pruebas en el puerto 8080, apuntando al entorno <strong>green</strong></li>
</ul>
<div class="highlight"><pre><span></span>gerard@sirius:~/workspace$ curl http://proxy/fake/
<span class="o">{</span><span class="s2">&quot;status&quot;</span>: <span class="s2">&quot;200&quot;</span>, <span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;Everything is OK&quot;</span>, <span class="s2">&quot;version&quot;</span>: <span class="s2">&quot;1.0.0&quot;</span>, <span class="s2">&quot;server&quot;</span>: <span class="s2">&quot;blue1&quot;</span><span class="o">}</span>
gerard@sirius:~/workspace$ curl http://proxy/fake/
<span class="o">{</span><span class="s2">&quot;status&quot;</span>: <span class="s2">&quot;200&quot;</span>, <span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;Everything is OK&quot;</span>, <span class="s2">&quot;version&quot;</span>: <span class="s2">&quot;1.0.0&quot;</span>, <span class="s2">&quot;server&quot;</span>: <span class="s2">&quot;blue2&quot;</span><span class="o">}</span>
gerard@sirius:~/workspace$ curl http://proxy/fake/
<span class="o">{</span><span class="s2">&quot;status&quot;</span>: <span class="s2">&quot;200&quot;</span>, <span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;Everything is OK&quot;</span>, <span class="s2">&quot;version&quot;</span>: <span class="s2">&quot;1.0.0&quot;</span>, <span class="s2">&quot;server&quot;</span>: <span class="s2">&quot;blue1&quot;</span><span class="o">}</span>
gerard@sirius:~/workspace$ curl http://proxy/fake/
<span class="o">{</span><span class="s2">&quot;status&quot;</span>: <span class="s2">&quot;200&quot;</span>, <span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;Everything is OK&quot;</span>, <span class="s2">&quot;version&quot;</span>: <span class="s2">&quot;1.0.0&quot;</span>, <span class="s2">&quot;server&quot;</span>: <span class="s2">&quot;blue2&quot;</span><span class="o">}</span>
gerard@sirius:~/workspace$ 
</pre></div>


<div class="highlight"><pre><span></span>gerard@sirius:~/workspace$ curl http://proxy:8080/fake/
<span class="o">{</span><span class="s2">&quot;status&quot;</span>: <span class="s2">&quot;200&quot;</span>, <span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;Everything is OK&quot;</span>, <span class="s2">&quot;version&quot;</span>: <span class="s2">&quot;1.0.0&quot;</span>, <span class="s2">&quot;server&quot;</span>: <span class="s2">&quot;green1&quot;</span><span class="o">}</span>
gerard@sirius:~/workspace$ curl http://proxy:8080/fake/
<span class="o">{</span><span class="s2">&quot;status&quot;</span>: <span class="s2">&quot;200&quot;</span>, <span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;Everything is OK&quot;</span>, <span class="s2">&quot;version&quot;</span>: <span class="s2">&quot;1.0.0&quot;</span>, <span class="s2">&quot;server&quot;</span>: <span class="s2">&quot;green2&quot;</span><span class="o">}</span>
gerard@sirius:~/workspace$ curl http://proxy:8080/fake/
<span class="o">{</span><span class="s2">&quot;status&quot;</span>: <span class="s2">&quot;200&quot;</span>, <span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;Everything is OK&quot;</span>, <span class="s2">&quot;version&quot;</span>: <span class="s2">&quot;1.0.0&quot;</span>, <span class="s2">&quot;server&quot;</span>: <span class="s2">&quot;green1&quot;</span><span class="o">}</span>
gerard@sirius:~/workspace$ curl http://proxy:8080/fake/
<span class="o">{</span><span class="s2">&quot;status&quot;</span>: <span class="s2">&quot;200&quot;</span>, <span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;Everything is OK&quot;</span>, <span class="s2">&quot;version&quot;</span>: <span class="s2">&quot;1.0.0&quot;</span>, <span class="s2">&quot;server&quot;</span>: <span class="s2">&quot;green2&quot;</span><span class="o">}</span>
gerard@sirius:~/workspace$ 
</pre></div>


<h3>Un despliegue fallido</h3>
<p>Desplegamos una nueva versión en el entorno de pruebas, actualmente como entorno <strong>green</strong>. Eso significa deplegar nueva versión en <em>green1</em> y en <em>green2</em>. Como el entorno de producción es <strong>blue</strong>, cualquier desastre que pase en <strong>green</strong> no va a afectar a la operativa.</p>
<p>Tras subir <strong>green</strong> a la versión 1.1.0, vemos en el <em>endpoint</em> de pruebas que no funciona:</p>
<div class="highlight"><pre><span></span>gerard@sirius:~/workspace$ curl http://proxy:8080/fake/
<span class="o">{</span><span class="s2">&quot;status&quot;</span>: <span class="s2">&quot;500&quot;</span>, <span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;Errors everywhere...&quot;</span>, <span class="s2">&quot;version&quot;</span>: <span class="s2">&quot;1.1.0&quot;</span>, <span class="s2">&quot;server&quot;</span>: <span class="s2">&quot;green1&quot;</span><span class="o">}</span>
gerard@sirius:~/workspace$ curl http://proxy:8080/fake/
<span class="o">{</span><span class="s2">&quot;status&quot;</span>: <span class="s2">&quot;500&quot;</span>, <span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;Errors everywhere...&quot;</span>, <span class="s2">&quot;version&quot;</span>: <span class="s2">&quot;1.1.0&quot;</span>, <span class="s2">&quot;server&quot;</span>: <span class="s2">&quot;green2&quot;</span><span class="o">}</span>
gerard@sirius:~/workspace$ 
</pre></div>


<p>Pero no pasa nada; el entorno de producción sigue apuntando a <strong>blue</strong>, que no hemos modificado y por lo tanto, sigue funcionando con la versión anterior.</p>
<div class="highlight"><pre><span></span>gerard@sirius:~/workspace$ curl http://proxy/fake/
<span class="o">{</span><span class="s2">&quot;status&quot;</span>: <span class="s2">&quot;200&quot;</span>, <span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;Everything is OK&quot;</span>, <span class="s2">&quot;version&quot;</span>: <span class="s2">&quot;1.0.0&quot;</span>, <span class="s2">&quot;server&quot;</span>: <span class="s2">&quot;blue1&quot;</span><span class="o">}</span>
gerard@sirius:~/workspace$ curl http://proxy/fake/
<span class="o">{</span><span class="s2">&quot;status&quot;</span>: <span class="s2">&quot;200&quot;</span>, <span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;Everything is OK&quot;</span>, <span class="s2">&quot;version&quot;</span>: <span class="s2">&quot;1.0.0&quot;</span>, <span class="s2">&quot;server&quot;</span>: <span class="s2">&quot;blue2&quot;</span><span class="o">}</span>
gerard@sirius:~/workspace$ 
</pre></div>


<p>Basta con no cambiar la configuración del <strong>nginx</strong> en el servidor <em>proxy</em> para no exponer el desastre más allá del entorno de pruebas. Si algún manazas hubiera cambiado ya la configuración del <em>proxy</em>, el <em>rollback</em> consistiría en modificar de nuevo la configuración del <em>proxy</em>.</p>
<h3>Un despliegue con éxito</h3>
<p>Tras investigar el problema de la nueva versión, se localiza un <em>bug</em> que causa los errores y se escribe un <em>hotfix</em>, que se libera como version 1.1.1; supongamos que tenemos éxito.</p>
<div class="highlight"><pre><span></span>gerard@sirius:~/workspace$ curl http://proxy:8080/fake/
<span class="o">{</span><span class="s2">&quot;status&quot;</span>: <span class="s2">&quot;200&quot;</span>, <span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;Everything is OK&quot;</span>, <span class="s2">&quot;version&quot;</span>: <span class="s2">&quot;1.1.1&quot;</span>, <span class="s2">&quot;server&quot;</span>: <span class="s2">&quot;green1&quot;</span><span class="o">}</span>
gerard@sirius:~/workspace$ curl http://proxy:8080/fake/
<span class="o">{</span><span class="s2">&quot;status&quot;</span>: <span class="s2">&quot;200&quot;</span>, <span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;Everything is OK&quot;</span>, <span class="s2">&quot;version&quot;</span>: <span class="s2">&quot;1.1.1&quot;</span>, <span class="s2">&quot;server&quot;</span>: <span class="s2">&quot;green2&quot;</span><span class="o">}</span>
gerard@sirius:~/workspace$ 
</pre></div>


<p>Basta con modificar la configuración del <em>proxy</em> para que producción apunte a <strong>green</strong>, en donde tenemos la nueva versión estable. En el caso de la configuración expuesta anteriormente, bastaría con cambiar las directivas <code>proxy_pass</code>.</p>
<div class="highlight"><pre><span></span>root@proxy:~# cat /etc/nginx/conf.d/api.conf 
upstream blue <span class="o">{</span>
    server blue1:8080<span class="p">;</span>
    server blue2:8080<span class="p">;</span>
<span class="o">}</span>

upstream green <span class="o">{</span>
    server green1:8080<span class="p">;</span>
    server green2:8080<span class="p">;</span>
<span class="o">}</span>

server <span class="o">{</span>
    listen <span class="m">80</span><span class="p">;</span>
    location / <span class="o">{</span>
        proxy_pass http://green<span class="p">;</span>
    <span class="o">}</span>
<span class="o">}</span>

server <span class="o">{</span>
    listen <span class="m">8080</span><span class="p">;</span>
    location / <span class="o">{</span>
        proxy_pass http://blue<span class="p">;</span>
    <span class="o">}</span>
<span class="o">}</span>
root@proxy:~# nginx -s reload
<span class="m">2018</span>/05/07 <span class="m">17</span>:43:26 <span class="o">[</span>notice<span class="o">]</span> <span class="m">21</span><span class="c1">#21: signal process started</span>
root@proxy:~# 
</pre></div>


<p>Puesto que un <em>reload</em> del <strong>nginx</strong> no provoca pérdida de paquetes ni de peticiones, solo queda ver que las peticiones del entorno de producción son atendidas en los servidores <em>green1</em> y <em>green2</em>.</p>
<div class="highlight"><pre><span></span>gerard@sirius:~/workspace$ curl http://proxy/fake/
<span class="o">{</span><span class="s2">&quot;status&quot;</span>: <span class="s2">&quot;200&quot;</span>, <span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;Everything is OK&quot;</span>, <span class="s2">&quot;version&quot;</span>: <span class="s2">&quot;1.1.1&quot;</span>, <span class="s2">&quot;server&quot;</span>: <span class="s2">&quot;green1&quot;</span><span class="o">}</span>
gerard@sirius:~/workspace$ curl http://proxy/fake/
<span class="o">{</span><span class="s2">&quot;status&quot;</span>: <span class="s2">&quot;200&quot;</span>, <span class="s2">&quot;message&quot;</span>: <span class="s2">&quot;Everything is OK&quot;</span>, <span class="s2">&quot;version&quot;</span>: <span class="s2">&quot;1.1.1&quot;</span>, <span class="s2">&quot;server&quot;</span>: <span class="s2">&quot;green2&quot;</span><span class="o">}</span>
gerard@sirius:~/workspace$ 
</pre></div>


<p>En este punto, el estado de nuestro servicio ha cambiado; ahora tenemos:</p>
<ul>
<li>Entorno de producción en el puerto 80, apuntando al entorno <strong>green</strong>, con versión 1.1.1</li>
<li>Entorno de pruebas en el puerto 8080, apuntando al entorno <strong>blue</strong>, con versión 1.0.0</li>
</ul>
<p>Por lo tanto, los nuevos despliegues se harían en el entorno <strong>blue</strong>, que ha dejado de ser el entorno de producción en favor del entorno <strong>green</strong>. Como pequeño detalle, sería interesante subir <strong>blue</strong> a la versión nueva, para tener ambos entornos idénticos, como punto de partida para una posible nueva versión.</p>
<h2>Y que pasa con las bases de datos?</h2>
<p>En realidad es un problema que no solo atañe a las bases de datos; otras partes <em>stateful</em> como sistemas de ficheros, colas y APIs remotas también deben ser tratadas en este caso. Este es un tema que no queda bien reflejado, habiendo dos corrientes enfrentadas que defienden sus puntos de vista:</p>
<ul>
<li>Bases de datos duplicadas</li>
<li>Bases de datos compartidas</li>
</ul>
<p>En caso de duplicar la base de datos en ambos entornos, ganamos la posibilidad de modificarla en nuestros <em>tests</em>, ya que las pruebas en el entorno de pruebas no van a afectar al entorno de producción. El problema en este punto es que tenemos la necesidad de mantenerlas sincronizadas, pudiendo ser un proceso lento en caso de un conjunto de datos grande.</p>
<p>Si compartimos la base de datos entre los entornos <strong>blue</strong> y <strong>green</strong>, nos ahorramos la sincronización, a costa de no poder modificar nada en el entorno de pruebas, ya que estaríamos modificando los mismos datos que se usan en el entorno de producción.</p>
<p>Un punto espinoso en esta configuración compartido son las migraciones de la base de datos; hacerlas antes causaría <em>downtime</em> en la versión anterior hasta instalar la nueva versión, y hacerlas después causaría <em>downtime</em> en la nueva versión hasta poder hacer la migración. La solución más aceptada es hacer una <em>release</em> intermedia, capaz de trabajar con la base de datos migrada y sin migrar; sería responsabilidad de esta <em>release</em> intermedia detectar si la base de datos está migrada o no, y suplir las carencias mediante lógica específica.</p>
            </div>
            <!-- /.entry-content -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'linuxsysadmin-gmb'; // required: replace example with your forum shortname

                    var disqus_identifier = 'despliegues-sin-corte-de-servicio-blue-green-deployments';
                var disqus_url = 'http://www.linuxsysadmin.ml/2018/05/despliegues-sin-corte-de-servicio-blue-green-deployments.html';

            var disqus_config = function () {
                this.language = "es";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>

<section class="well well-sm">
    <ul class="list-group list-group-flush">
            <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
              <ul class="list-group" id="social">
                <li class="list-group-item"><a href="https://github.com/sirtea"><i class="fa fa-github-square fa-lg"></i> GitHub</a></li>
              </ul>
            </li>


            <li class="list-group-item"><a href="http://www.linuxsysadmin.ml/categories.html"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Categorías</span></h4></a>
                <ul class="list-group" id="categories">
                    <li class="list-group-item">
                        <a href="http://www.linuxsysadmin.ml/category/desarrollo.html">
                            <i class="fa fa-folder-open fa-lg"></i> Desarrollo
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="http://www.linuxsysadmin.ml/category/miscelanea.html">
                            <i class="fa fa-folder-open fa-lg"></i> Miscelánea
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="http://www.linuxsysadmin.ml/category/operaciones.html">
                            <i class="fa fa-folder-open fa-lg"></i> Operaciones
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="http://www.linuxsysadmin.ml/category/seguridad.html">
                            <i class="fa fa-folder-open fa-lg"></i> Seguridad
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="http://www.linuxsysadmin.ml/category/sistemas.html">
                            <i class="fa fa-folder-open fa-lg"></i> Sistemas
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="http://www.linuxsysadmin.ml/category/virtualizacion.html">
                            <i class="fa fa-folder-open fa-lg"></i> Virtualización
                        </a>
                    </li>
                </ul>
            </li>

<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Sidebar linuxsysadmin -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-6984858420847602"
     data-ad-slot="1931313371"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

            <li class="list-group-item"><a href="http://www.linuxsysadmin.ml/tags.html"><h4><i class="fa fa-tags fa-lg"></i><span class="icon-label">Tags</span></h4></a>
                <ul class="list-group list-inline tagcloud" id="tags">
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/2-way-ssl.html">
                            2 way ssl
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.linuxsysadmin.ml/tag/alpine.html">
                            alpine
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://www.linuxsysadmin.ml/tag/ansible.html">
                            ansible
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/api.html">
                            api
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/apt.html">
                            apt
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/archlinux.html">
                            archlinux
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://www.linuxsysadmin.ml/tag/autenticacion.html">
                            autenticación
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.linuxsysadmin.ml/tag/authorized_keys.html">
                            authorized_keys
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://www.linuxsysadmin.ml/tag/balanceador.html">
                            balanceador
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/bash.html">
                            bash
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/basico.html">
                            básico
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/blog.html">
                            blog
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.linuxsysadmin.ml/tag/bloques-reservados.html">
                            bloques reservados
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/bridge.html">
                            bridge
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/build.html">
                            build
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/cache.html">
                            cache
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/centos.html">
                            centos
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/certificado.html">
                            certificado
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://www.linuxsysadmin.ml/tag/cluster.html">
                            cluster
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/consul.html">
                            consul
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/contenedor.html">
                            contenedor
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.linuxsysadmin.ml/tag/css.html">
                            CSS
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/curl.html">
                            curl
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://www.linuxsysadmin.ml/tag/debian.html">
                            debian
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/debootstrap.html">
                            debootstrap
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.linuxsysadmin.ml/tag/dig.html">
                            dig
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://www.linuxsysadmin.ml/tag/dns.html">
                            dns
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/dnsmasq.html">
                            dnsmasq
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://www.linuxsysadmin.ml/tag/docker.html">
                            docker
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://www.linuxsysadmin.ml/tag/docker-compose.html">
                            docker-compose
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://www.linuxsysadmin.ml/tag/dockerfile.html">
                            Dockerfile
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.linuxsysadmin.ml/tag/drill.html">
                            drill
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/escritorio.html">
                            escritorio
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/failover.html">
                            failover
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://www.linuxsysadmin.ml/tag/firehol.html">
                            firehol
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/flask.html">
                            flask
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://www.linuxsysadmin.ml/tag/framework.html">
                            framework
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/gateway.html">
                            gateway
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/ghost.html">
                            ghost
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://www.linuxsysadmin.ml/tag/git.html">
                            git
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/haproxy.html">
                            haproxy
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.linuxsysadmin.ml/tag/histfile.html">
                            histfile
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/html.html">
                            html
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/https.html">
                            https
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://www.linuxsysadmin.ml/tag/jaula.html">
                            jaula
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://www.linuxsysadmin.ml/tag/jessie.html">
                            jessie
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/keepalived.html">
                            keepalived
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://www.linuxsysadmin.ml/tag/linux.html">
                            linux
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/logical-volume-manager.html">
                            logical volume manager
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/logs.html">
                            logs
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/logstash.html">
                            logstash
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/lvm.html">
                            lvm
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/lxc.html">
                            lxc
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/markdown.html">
                            markdown
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.linuxsysadmin.ml/tag/memoria.html">
                            memoria
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://www.linuxsysadmin.ml/tag/microframework.html">
                            microframework
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.linuxsysadmin.ml/tag/migracion.html">
                            migración
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://www.linuxsysadmin.ml/tag/mongodb.html">
                            mongodb
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/mount.html">
                            mount
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://www.linuxsysadmin.ml/tag/nginx.html">
                            nginx
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/nmap.html">
                            nmap
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/passphrase.html">
                            passphrase
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://www.linuxsysadmin.ml/tag/password.html">
                            password
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.linuxsysadmin.ml/tag/pets-vs-cattle.html">
                            pets vs cattle
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/php.html">
                            php
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://www.linuxsysadmin.ml/tag/playbook.html">
                            playbook
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/proxy.html">
                            proxy
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/pypi.html">
                            PyPI
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://www.linuxsysadmin.ml/tag/python.html">
                            python
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/redhat.html">
                            redhat
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.linuxsysadmin.ml/tag/remota.html">
                            remota
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://www.linuxsysadmin.ml/tag/replica-set.html">
                            replica set
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/rest.html">
                            REST
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/rssh.html">
                            rssh
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/rsync.html">
                            rsync
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.linuxsysadmin.ml/tag/s6.html">
                            s6
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/script.html">
                            script
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/service-discovery.html">
                            service discovery
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/sftp.html">
                            sftp
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.linuxsysadmin.ml/tag/shadow.html">
                            shadow
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/sharding.html">
                            sharding
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/squashfs.html">
                            squashfs
                        </a>
                    </li>
                    <li class="list-group-item tag-1">
                        <a href="http://www.linuxsysadmin.ml/tag/ssh.html">
                            ssh
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.linuxsysadmin.ml/tag/sshfs.html">
                            sshfs
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://www.linuxsysadmin.ml/tag/ssl.html">
                            ssl
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/stretch.html">
                            stretch
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/swarm.html">
                            swarm
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://www.linuxsysadmin.ml/tag/systemd.html">
                            systemd
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.linuxsysadmin.ml/tag/traefik.html">
                            traefik
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.linuxsysadmin.ml/tag/tune2fs.html">
                            tune2fs
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://www.linuxsysadmin.ml/tag/tunel.html">
                            túnel
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/ubuntu.html">
                            ubuntu
                        </a>
                    </li>
                    <li class="list-group-item tag-4">
                        <a href="http://www.linuxsysadmin.ml/tag/unidad.html">
                            unidad
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/uwsgi.html">
                            uWSGI
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/variable.html">
                            variable
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/virtual-hosts.html">
                            virtual hosts
                        </a>
                    </li>
                    <li class="list-group-item tag-2">
                        <a href="http://www.linuxsysadmin.ml/tag/virtualenv.html">
                            virtualenv
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/volumenes.html">
                            volumenes
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/wheel.html">
                            wheel
                        </a>
                    </li>
                    <li class="list-group-item tag-3">
                        <a href="http://www.linuxsysadmin.ml/tag/xfce.html">
                            xfce
                        </a>
                    </li>
                </ul>
            </li>


    </ul>
</section>
            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2018 Gerard
            &middot; Generado por <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Volver arriba</a></p></div>
      </div>
   </div>
</footer>
<script src="http://www.linuxsysadmin.ml/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://www.linuxsysadmin.ml/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://www.linuxsysadmin.ml/theme/js/respond.min.js"></script>

    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'linuxsysadmin-gmb'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->
    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-68486572-1']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <!-- End Google Analytics Code -->

</body>
</html>